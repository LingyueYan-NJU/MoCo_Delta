type: List[Tensor]. The tensors to compute the Einstein summation of.   Return type Tensor   Examples: >>> # trace >>> torch.einsum('ii', torch.randn(4, 4)) tensor(-1.2104)  >>> # diagonal >>> torch.einsum('ii->i', torch.randn(4, 4)) tensor([-0.1034,  0.7952, -0.2433,  0.4545])  >>> # outer product >>> x = torch.randn(5) >>> y = torch.randn(4) >>> torch.einsum('i,j->ij', x, y) tensor([[ 0.1156, -0.2897, -0.3918,  0.4963],         [-0.3744,  0.9381,  1.2685, -1.6070],         [ 0.7208, -1.8058, -2.4419,  3.0936],         [ 0.1713, -0.4291, -0.5802,  0.7350],         [ 0.5704, -1.4290, -1.9323,  2.4480]])  >>> # batch matrix multiplication >>> As = torch.randn(3, 2, 5) >>> Bs = torch.randn(3, 5, 4) >>> torch.einsum('bij,bjk->bik', As, Bs) tensor([[[-1.0564, -1.5904,  3.2023,  3.1271],         [-1.6706, -0.8097, -0.8025, -2.1183]],          [[ 4.2239,  0.3107, -0.5756, -0.2354],         [-1.4558, -0.3460,  1.5087, -0.8530]],          [[ 2.8153,  1.8787, -4.3839, -1.2112],         [ 0.3728, -2.1131,  0.0921,  0.8305]]])  >>> # with sublist format and ellipsis >>> torch.einsum(As, [..., 0, 1], Bs, [..., 1, 2], [..., 0, 2]) tensor([[[-1.0564, -1.5904,  3.2023,  3.1271],         [-1.6706, -0.8097, -0.8025, -2.1183]],          [[ 4.2239,  0.3107, -0.5756, -0.2354],         [-1.4558, -0.3460,  1.5087, -0.8530]],          [[ 2.8153,  1.8787, -4.3839, -1.2112],         [ 0.3728, -2.1131,  0.0921,  0.8305]]])  >>> # batch permute >>> A = torch.randn(2, 3, 4, 5) >>> torch.einsum('...ij->...ji', A).shape torch.Size([2, 3, 5, 4])  >>> # equivalent to torch.nn.functional.bilinear >>> A = torch.randn(3, 5, 4) >>> l = torch.randn(2, 5) >>> r = torch.randn(2, 4) >>> torch.einsum('bn,anm,bm->ba', l, A, r) tensor([[-0.3430, -5.2405,  0.4494],         [ 0.3311,  5.5201, -3.0356]])                                                                                     Next                         Previous                                               © Copyright 2023, PyTorch Contributors.                              Built with Sphinx using a theme provided by Read the Docs.                              var match = window.location.href.match(/\/_[a-zA-Z0-9_]*.html|_dynamo/gi); var url = window.location.href.lastIndexOf(match[match.length-1]);  if (url)   {     var div = '<div class="admonition note"><p class="admonition-title">Note</p><p><i class="fa fa-exclamation-circle" aria-hidden="true">&nbsp</i> This page describes an internal API which is not intended to be used outside of the PyTorch codebase and can be modified or removed without notice.</p></div>'     document.getElementById("pytorch-article").insertAdjacentHTML('afterBegin', div)   }                                                            torch.einsum einsum()                                                                                                                                                                                           jQuery(function () {           SphinxRtdTheme.Navigation.enable(true);       });         var collapsedSections = ['Developer Notes', 'Language Bindings', 'Libraries', 'Community'];                                            Docs           Access comprehensive developer documentation for PyTorch           View Docs                              Tutorials           Get in-depth tutorials for beginners and advanced developers           View Tutorials                              Resources           Find development resources and get your questions answered           View Resources                                                                                                 PyTorch             Get Started             Features             Ecosystem             Blog             Contributing                                                      Resources             Tutorials             Docs             Discuss             Github Issues             Brand Guidelines                                                      Stay up to date             Facebook             Twitter             YouTube             LinkedIn                                                          PyTorch Podcasts             Spotify             Apple             Google             Amazon                                                                        Terms             |             Privacy                                      © Copyright The Linux Foundation. The PyTorch Foundation is a project of The Linux Foundation.           For web site terms of use, trademark policy and other policies applicable to The PyTorch Foundation please see           www.linuxfoundation.org/policies/. The PyTorch Foundation supports the PyTorch open source           project, which has been established as PyTorch Project a Series of LF Projects, LLC. For policies applicable to the PyTorch Project a Series of LF Projects, LLC,           please see www.lfprojects.org/policies/.                             To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: Cookies Policy.                                                                                                                                   Get Started                                    Ecosystem                                                Mobile                                    Blog                                    Tutorials                                    Docs                                                   PyTorch                                          torchaudio                                          torchtext                                          torchvision                                          torcharrow                                          TorchData                                          TorchRec                                          TorchServe                                          TorchX                                          PyTorch on XLA Devices                                                 Resources                                                                 About                                          PyTorch Foundation                                          Community                                          Community Stories                                          Developer Resources                                          Events                                          Forums                                          Models (Beta)                                                 Github                                                    $(document).ready(function() {       mobileMenu.bind();       mobileTOC.bind();       pytorchAnchors.bind();       sideMenus.bind();       scrollToAnchor.bind();       highlightNavigation.bind();       mainMenuDropdown.bind();       filterTags.bind();        // Add class to links that have code blocks, since we cannot create links in code blocks       $("article.pytorch-article a span.pre").each(function(e) {         $(this).closest("a").addClass("has-code");       });     })     