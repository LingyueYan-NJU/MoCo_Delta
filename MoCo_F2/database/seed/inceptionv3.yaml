inceptionv3:
  - layer: conv2d
    params:
      in_channels: 3
      out_channels: 32
      kernel_size: 3
      padding: 1
      bias: False
    in: x
    out: x
  - layer: batchnorm2d
    params:
      num_features: 32
    in: x
    out: x
  - layer: relu
    params:
      inplace: True
    in: x
    out: x
  - layer: conv2d
    params:
      in_channels: 32
      out_channels: 32
      kernel_size: 3
      padding: 1
      bias: False
    in: x
    out: x
  - layer: batchnorm2d
    params:
      num_features: 32
    in: x
    out: x
  - layer: relu
    params:
      inplace: True
    in: x
    out: x
  - layer: conv2d
    params:
      in_channels: 32
      out_channels: 64
      kernel_size: 3
      padding: 1
      bias: False
    in: x
    out: x
  - layer: batchnorm2d
    params:
      num_features: 64
    in: x
    out: x
  - layer: relu
    params:
      inplace: True
    in: x
    out: x
  - layer: conv2d
    params:
      in_channels: 64
      out_channels: 80
      kernel_size: 1
      bias: False
    in: x
    out: x
  - layer: batchnorm2d
    params:
      num_features: 80
    in: x
    out: x
  - layer: relu
    params:
      inplace: True
    in: x
    out: x
  - layer: conv2d
    params:
      in_channels: 80
      out_channels: 192
      kernel_size: 3
      bias: False
    in: x
    out: x
  - layer: batchnorm2d
    params:
      num_features: 192
    in: x
    out: x
  - layer: relu
    params:
      inplace: True
    in: x
    out: x

  - layer: inceptiona
    params:
      input_channels: 192
      pool_features: 32
    in: x
    out: x
  - layer: inceptiona
    params:
      input_channels: 256
      pool_features: 64
    in: x
    out: x
  - layer: inceptiona
    params:
      input_channels: 288
      pool_features: 64
    in: x
    out: x
  - layer: inceptionb
    params:
      input_channels: 288
    in: x
    out: x
  - layer: inceptionc
    params:
      input_channels: 768
      channels_7x7: 128
    in: x
    out: x
  - layer: inceptionc
    params:
      input_channels: 768
      channels_7x7: 160
    in: x
    out: x
  - layer: inceptionc
    params:
      input_channels: 768
      channels_7x7: 160
    in: x
    out: x
  - layer: inceptionc
    params:
      input_channels: 768
      channels_7x7: 192
    in: x
    out: x
  - layer: inceptiond
    params:
      input_channels: 768
    in: x
    out: x
  - layer: inceptione
    params:
      input_channels: 1280
    in: x
    out: x
  - layer: inceptione
    params:
      input_channels: 2048
    in: x
    out: x
  - layer: adaptiveavgpool2d
    params:
      output_size: (1, 1)
    in: x
    out: x
  - layer: dropout2d
    params: {}
    in: x
    out: x
  - layer: flatten
    params: {}
    in: x
    out: x
  - layer: linear
    params:
      in_features: 2048
      out_features: num_classes
    in: x
    out: x
inceptiona:
  - ["in_channels", "out_channels1", "out_channels2reduce", "out_channels2", "out_channels3reduce", "out_channels3", "out_channels4"]
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 64
      kernel_size: 1
      bias: False
    in: x
    out: branch1
  - layer: batchnorm2d
    params:
      num_features: 64
    in: branch1
    out: branch1
  - layer: relu
    params:
      inplace: True
    in: branch1
    out: branch1
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 48
      kernel_size: 1
      bias: False
    in: x
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 48
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: 48
      out_channels: 64
      kernel_size: 5
      padding: 2
      bias: False
    in: branch2
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 64
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 64
      kernel_size: 1
      bias: False
    in: x
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: 64
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: conv2d
    params:
      in_channels: 64
      out_channels: 96
      kernel_size: 3
      padding: 1
      bias: False
    in: branch3
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: 96
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: conv2d
    params:
      in_channels: 96
      out_channels: 96
      kernel_size: 3
      padding: 1
      bias: False
    in: branch3
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: 96
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: avgpool2d
    params:
      kernel_size: 3
      stride: 1
      padding: 1
    in: x
    out: branch4
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: pool_features
      kernel_size: 3
      padding: 1
      bias: False
    in: branch4
    out: branch4
  - layer: batchnorm2d
    params:
      num_features: pool_features
    in: branch4
    out: branch4
  - layer: relu
    params:
      inplace: True
    in: branch4
    out: branch4
  - layer: cat
    params: { }
    in: [branch1, branch2, branch3, branch4], 1
    out: x
inceptionb:
  - ["in_channels", "out_channels1", "out_channels2reduce", "out_channels2", "out_channels3reduce", "out_channels3", "out_channels4"]
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 384
      kernel_size: 3
      stride: 2
      bias: False
    in: x
    out: branch1
  - layer: batchnorm2d
    params:
      num_features: 384
    in: branch1
    out: branch1
  - layer: relu
    params:
      inplace: True
    in: branch1
    out: branch1
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 64
      kernel_size: 1
      bias: False
    in: x
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 64
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: 64
      out_channels: 96
      kernel_size: 3
      padding: 1
      bias: False
    in: branch2
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 96
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: 96
      out_channels: 96
      kernel_size: 3
      stride: 2
      bias: False
    in: branch2
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 96
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: maxpool2d
    params:
      kernel_size: 3
      stride: 2
    in: branch3
    out: branch3
  - layer: cat
    params: { }
    in: [branch1, branch2, branch3], 1
    out: x
inceptionc:
  - ["in_channels", "out_channels1", "out_channels2reduce", "out_channels2", "out_channels3reduce", "out_channels3", "out_channels4"]
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 192
      kernel_size: 1
      bias: False
    in: x
    out: branch1
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch1
    out: branch1
  - layer: relu
    params:
      inplace: True
    in: branch1
    out: branch1
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: channels_7x7
      kernel_size: 1
      bias: False
    in: x
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: channels_7x7
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: channels_7x7
      out_channels: channels_7x7
      kernel_size: (7, 1)
      padding: (3, 0)
      bias: False
    in: branch2
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: channels_7x7
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: channels_7x7
      out_channels: 192
      kernel_size: (1, 7)
      padding: (0, 3)
      bias: False
    in: branch2
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: channels_7x7
      kernel_size: 1
      bias: False
    in: x
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: channels_7x7
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: conv2d
    params:
      in_channels: channels_7x7
      out_channels: channels_7x7
      kernel_size: (7, 1)
      padding: (3, 0)
      bias: False
    in: branch3
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: channels_7x7
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: conv2d
    params:
      in_channels: channels_7x7
      out_channels: channels_7x7
      kernel_size: (1, 7)
      padding: (0, 3)
      bias: False
    in: branch3
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: channels_7x7
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: conv2d
    params:
      in_channels: channels_7x7
      out_channels: channels_7x7
      kernel_size: (7, 1)
      padding: (3, 0)
      bias: False
    in: branch3
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: channels_7x7
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: conv2d
    params:
      in_channels: channels_7x7
      out_channels: 192
      kernel_size: (1, 7)
      padding: (0, 3)
      bias: False
    in: branch3
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: avgpool2d
    params:
      kernel_size: 3
      stride: 1
      padding: 1
    in: x
    out: branch4
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 192
      kernel_size: 1
      bias: False
    in: branch4
    out: branch4
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch4
    out: branch4
  - layer: relu
    params:
      inplace: True
    in: branch4
    out: branch4
  - layer: cat
    params: { }
    in: [ branch1, branch2, branch3, branch4 ], 1
    out: x
inceptiond:
  - ["in_channels", "out_channels1reduce", "out_channels1", "out_channels2reduce", "out_channels2"]
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 192
      kernel_size: 1
      bias: False
    in: x
    out: branch1
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch1
    out: branch1
  - layer: relu
    params:
      inplace: True
    in: branch1
    out: branch1
  - layer: conv2d
    params:
      in_channels: 192
      out_channels: 320
      kernel_size: 3
      stride: 2
      bias: False
    in: branch1
    out: branch1
  - layer: batchnorm2d
    params:
      num_features: 320
    in: branch1
    out: branch1
  - layer: relu
    params:
      inplace: True
    in: branch1
    out: branch1
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 192
      kernel_size: 1
      bias: False
    in: x
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: 192
      out_channels: 192
      kernel_size: (1, 7)
      padding: (0, 3)
      bias: False
    in: branch2
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: 192
      out_channels: 192
      kernel_size: (7, 1)
      padding: (3, 0)
      bias: False
    in: branch2
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: 192
      out_channels: 192
      kernel_size: 3
      stride: 2
      bias: False
    in: branch2
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: avgpool2d
    params:
      kernel_size: 3
      stride: 2
    in: x
    out: branch3
  - layer: cat
    params: { }
    in: [ branch1, branch2, branch3 ], 1
    out: x
inceptione:
  - ["in_channels", "out_channels1reduce", "out_channels1", "out_channels2reduce", "out_channels2"]
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 320
      kernel_size: 1
      bias: False
    in: x
    out: branch1
  - layer: batchnorm2d
    params:
      num_features: 320
    in: branch1
    out: branch1
  - layer: relu
    params:
      inplace: True
    in: branch1
    out: branch1
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 384
      kernel_size: 1
      bias: False
    in: x
    out: branch2
  - layer: batchnorm2d
    params:
      num_features: 384
    in: branch2
    out: branch2
  - layer: relu
    params:
      inplace: True
    in: branch2
    out: branch2
  - layer: conv2d
    params:
      in_channels: 384
      out_channels: 384
      kernel_size: (1, 3)
      padding: (0, 1)
      bias: False
    in: branch2
    out: branch2a
  - layer: batchnorm2d
    params:
      num_features: 384
    in: branch2a
    out: branch2a
  - layer: relu
    params:
      inplace: True
    in: branch2a
    out: branch2a
  - layer: conv2d
    params:
      in_channels: 384
      out_channels: 384
      kernel_size: (3, 1)
      padding: (1, 0)
      bias: False
    in: branch2
    out: branch2b
  - layer: batchnorm2d
    params:
      num_features: 384
    in: branch2b
    out: branch2b
  - layer: relu
    params:
      inplace: True
    in: branch2b
    out: branch2b
  - layer: cat
    params:
    in: [branch2a, branch2b], 1
    out: branch2
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 448
      kernel_size: 1
      bias: False
    in: x
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: 448
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: conv2d
    params:
      in_channels: 448
      out_channels: 384
      kernel_size: 3
      padding: 1
      bias: False
    in: branch3
    out: branch3
  - layer: batchnorm2d
    params:
      num_features: 384
    in: branch3
    out: branch3
  - layer: relu
    params:
      inplace: True
    in: branch3
    out: branch3
  - layer: conv2d
    params:
      in_channels: 384
      out_channels: 384
      kernel_size: (1, 3)
      padding: (0, 1)
      bias: False
    in: branch3
    out: branch3a
  - layer: batchnorm2d
    params:
      num_features: 384
    in: branch3a
    out: branch3a
  - layer: relu
    params:
      inplace: True
    in: branch3a
    out: branch3a
  - layer: conv2d
    params:
      in_channels: 384
      out_channels: 384
      kernel_size: (3, 1)
      padding: (1, 0)
      bias: False
    in: branch3
    out: branch3b
  - layer: batchnorm2d
    params:
      num_features: 384
    in: branch3b
    out: branch3b
  - layer: relu
    params:
      inplace: True
    in: branch3b
    out: branch3b
  - layer: cat
    params: {}
    in: [branch3a, branch3b], 1
    out: branch3
  - layer: avgpool2d
    params:
      kernel_size: 3
      stride: 1
      padding: 1
    in: x
    out: branch4
  - layer: conv2d
    params:
      in_channels: input_channels
      out_channels: 192
      kernel_size: 1
      bias: False
    in: branch4
    out: branch4
  - layer: batchnorm2d
    params:
      num_features: 192
    in: branch4
    out: branch4
  - layer: relu
    params:
      inplace: True
    in: branch4
    out: branch4
  - layer: cat
    params:
      dims: 1
    in: [branch1, branch2, branch3, branch4]
    out: outputs